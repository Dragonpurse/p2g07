000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. PWGenerator.
       DATA DIVISION.
       LINKAGE SECTION.
       01 #rijen                PIC 9(3).  
       WORKING-STORAGE SECTION.
       01 lijstWW.
           05 randomWW          PIC X(8)        OCCURS 999 TIMES. 
       01 bereik.
           05 totaal            PIC X(62).
           05 hoofdletters      PIC X(26).
       01 waarde.
           05 randomvalue       PIC 9(2).
           05 hulpvalue         PIC X.
       01 conditie.
           05 #hoofdletters     PIC 9.
           05 #cijfers          PIC 9.
       01 tellers.
           05 i                 PIC 9(2).
           05 j                 PIC 9.
       PROCEDURE DIVISION USING #rijen RETURNING lijstWW.
       PGM.
          MOVE "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
                &"abcdefghijklmnopqrstuvwxyz1234567890" TO totaal
          MOVE "ABCDEFGHIJKLMNOPQRSTUVWXYZ" TO hoofdletters

          PERFORM VARYING i FROM 1 BY 1 UNTIL i > #rijen
          INITIALIZE #hoofdletters #cijfers randomWW(i)
          PERFORM VARYING j FROM 1 BY 1 UNTIL j > 8
              COMPUTE randomvalue = 1 + FUNCTION RANDOM * 62
              MOVE totaal(randomvalue:1) TO hulpvalue 
              
              EVALUATE randomvalue
              WHEN 1 THRU 26
               ADD 1 TO #Hoofdletters
              WHEN 53 THRU 62
               ADD 1 TO #Cijfers
              END-EVALUATE

              IF #cijfers < 2 AND j > 5 AND randomvalue < 53
              THEN COMPUTE randomvalue = FUNCTION RANDOM * 10
                   MOVE randomvalue (2:1) TO hulpvalue
                   ADD 1 TO #cijfers
              END-IF   
              
              IF #hoofdletters < 1 AND j > 7 AND randomvalue > 27
              THEN COMPUTE randomvalue = 1 + FUNCTION RANDOM * 26
                   MOVE hoofdletters (randomvalue:1) TO hulpvalue
                   ADD 1 TO #hoofdletters
              END-IF
              
              STRING randomWW(i)  DELIMITED BY SPACE
                     hulpvalue    DELIMITED BY SPACE
                     INTO randomWW(i)
                     
          END-PERFORM
          END-PERFORM
          EXIT PROGRAM
       .