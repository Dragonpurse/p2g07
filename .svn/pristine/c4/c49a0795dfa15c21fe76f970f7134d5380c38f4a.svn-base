000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. PWGenerator.
       DATA DIVISION. 
       WORKING-STORAGE SECTION.

       01 bereik.
           05 totaal            PIC X(62).
           05 hoofdletters      PIC X(26).
       01 waarde.
           05 randomvalue       PIC 9(2).
           05 hulpvalue         PIC X           OCCURS 8 TIMES.
       01 conditie.
           05 aantalHoofdletters     PIC 9.
           05 aantalCijfers          PIC 9.
           
       01 j                     PIC 9.
       01 paswoord              PIC X(30) VALUE SPACES.
       PROCEDURE DIVISION RETURNING paswoord.
       PGM.
          MOVE "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
                &"abcdefghijklmnopqrstuvwxyz1234567890" TO totaal
          MOVE "ABCDEFGHIJKLMNOPQRSTUVWXYZ" TO hoofdletters

          INITIALIZE aantalHoofdletters aantalCijfers
          PERFORM VARYING j FROM 1 BY 1 UNTIL j > 8
              COMPUTE randomvalue = 1 + FUNCTION RANDOM * 62
              MOVE totaal(randomvalue:1) TO hulpvalue(j) 

              IF randomvalue < 27 
              THEN ADD 1 TO aantalHoofdletters
              END-IF
              
              IF randomvalue > 52 
              THEN ADD 1 TO aantalCijfers
              END-IF
              
              IF aantalCijfers < 2 AND j > 5 AND randomvalue < 53
              THEN COMPUTE randomvalue = FUNCTION RANDOM * 10
                   MOVE randomvalue (2:1) TO hulpvalue (j)
                   ADD 1 TO aantalCijfers
              END-IF   
              
              IF aantalHoofdletters < 1 AND j > 7 AND randomvalue > 27
              THEN COMPUTE randomvalue = 1 + FUNCTION RANDOM * 26
                   MOVE hoofdletters (randomvalue:1) TO hulpvalue (j)
                   ADD 1 TO aantalHoofdletters
              END-IF   
          END-PERFORM
          PERFORM STRINGPW
          EXIT PROGRAM
       .
       
       STRINGPW.
          STRING hulpvalue(1) DELIMITED BY SPACE
                 hulpvalue(2) DELIMITED BY SPACE
                 hulpvalue(3) DELIMITED BY SPACE
                 hulpvalue(4) DELIMITED BY SPACE
                 hulpvalue(5) DELIMITED BY SPACE
                 hulpvalue(6) DELIMITED BY SPACE
                 hulpvalue(7) DELIMITED BY SPACE
                 hulpvalue(8) DELIMITED BY SPACE
                 INTO paswoord
       .