package testen;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.GregorianCalendar;

import junit.framework.Assert;

import org.joda.time.DateTime;
import org.junit.Before;
import org.junit.Test;

import domein.Document;
import domein.Leertraject;
import domein.LeertrajectController;
import domein.LeertrajectRepository;
import domein.Onderdeel;


public class UC2Test {

	private LeertrajectRepository lr;
	private LeertrajectController lc;
	private GregorianCalendar today = DateTime.now().toGregorianCalendar();
	private GregorianCalendar threeDaysFromNow = DateTime.now().plusDays(3).toGregorianCalendar();
	private GregorianCalendar oneYearFromNow = DateTime.now().plusYears(1).toGregorianCalendar();
	private GregorianCalendar past = new GregorianCalendar(2000, 01, 01);
	
	private ArrayList<String> tags = new ArrayList<String>(Arrays.asList("lol", "wut", "test"));
	private Onderdeel doc1 = new Document("TestDoc1", "Dit is een test document", tags, "2TIN", "C:/Users/Test/document1.docx");
	private Onderdeel doc2 = new Document("TestDoc2", "Dit is een tweede test document", tags, "3TIN", "C:/Users/Test/document2.docx");
	
	@Before
	public void before(){
		lr = new LeertrajectRepository();
		lc = new LeertrajectController(lr);
	}
	
	@Test
	public void testAanmakenLeertrajectCorrectParameters() {
		lc.aanmakenLeertraject("G001", "Titel", "DIT\nIS\nEEN\nOMSCHR", threeDaysFromNow, 
								"TIN", today, oneYearFromNow, "");
		Assert.assertEquals(lc.getGeselecteerdLeertraject().getLeertrajectCode(),"G001");
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testAanmakenLeertrajectVerkeerdeTitel() {
		lc.aanmakenLeertraject("G0001", "µ", "DIT\nIS\nEEN\nOMSCHR", threeDaysFromNow, 
								"TIN", today , oneYearFromNow, "");
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testAanmakenLeertrajectVerkeerdeStartDatum() {
		lc.aanmakenLeertraject("G0001", "titel", "DIT\nIS\nEEN\nOMSCHR", past, 
								"TIN", today , oneYearFromNow, "");
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testAanmakenLeertrajectVerkeerdeBeschikVan() {
		lc.aanmakenLeertraject("G0001", "titel", "DIT\nIS\nEEN\nOMSCHR", threeDaysFromNow, 
								"TIN", past , oneYearFromNow, "");
	}
	
	@Test(expected = IllegalArgumentException.class)
	public void testAanmakenLeertrajectVerkeerdeBeschikTot() {
		lc.aanmakenLeertraject("G0001", "titel", "DIT\nIS\nEEN\nOMSCHR", threeDaysFromNow, 
								"TIN", oneYearFromNow , past, "");
	}
	
	
	@Test
	public void kopieerLeertrajectZonderElementen() {
		lc.aanmakenLeertraject("G001", "Titel", "DIT\nIS\nEEN\nOMSCHR", threeDaysFromNow, "TIN", today, oneYearFromNow, "bjorn");
		Leertraject lt = lc.getGeselecteerdLeertraject();
		lc.kopieerLeertraject("G002", "", "", threeDaysFromNow, "WIN", today, oneYearFromNow, "");
		Leertraject kopieLt = lc.getGeselecteerdLeertraject();
		Assert.assertEquals(lt.getTitel(), kopieLt.getTitel());
		Assert.assertEquals(lt.getOmschrijving(), kopieLt.getOmschrijving());
	}
	
	@Test
	public void kopieerLeertrajectMetElementen() {
		lc.aanmakenLeertraject("G001", "Titel", "DIT\nIS\nEEN\nOMSCHR", threeDaysFromNow, "TIN", today, oneYearFromNow, "bjorn");
		lc.voegOnderdeelToe(doc1);
		lc.voegOnderdeelToe(doc2);
		Leertraject lt = lc.getGeselecteerdLeertraject();
		Document d = (Document) lt.getLijstOnderdelen().get(0);
		
		lc.kopieerLeertraject("G002", "", "", threeDaysFromNow, "WIN", today, oneYearFromNow, "");
		Leertraject kopieLt = lc.getGeselecteerdLeertraject();
		Document kopieD = (Document) kopieLt.getLijstOnderdelen().get(0);
		
		Assert.assertEquals(lt.getLijstOnderdelen().size(), kopieLt.getLijstOnderdelen().size());
		Assert.assertEquals(d.getLocatie(), kopieD.getLocatie());
	}
	
	
	@Test(expected = IllegalArgumentException.class)
	public void kopieerLeertrajectZelfdeCode(){
		lc.aanmakenLeertraject("G001", "Titel", "DIT\nIS\nEEN\nOMSCHR", threeDaysFromNow, "TIN", today, oneYearFromNow, "bjorn");
		lc.kopieerLeertraject("G001", "", "", threeDaysFromNow, "WIN", today, oneYearFromNow, "");
	}
	
	@Test
	public void kopieerLeertrajectLegeOptioneleVelden(){
		lc.aanmakenLeertraject("G001", "Titel", "DIT\nIS\nEEN\nOMSCHR", threeDaysFromNow, "TIN", today, oneYearFromNow, "");
		Leertraject lt = lc.getGeselecteerdLeertraject();
		lc.kopieerLeertraject("G002", "", "", threeDaysFromNow, "", today, oneYearFromNow, "");
		Leertraject kopieLt = lc.getGeselecteerdLeertraject();
		
		Assert.assertEquals(lt.getTitel(), kopieLt.getTitel());
		Assert.assertEquals(lt.getOmschrijving(), kopieLt.getOmschrijving());
		Assert.assertEquals(lt.getDoelgroep(), kopieLt.getDoelgroep());	
	}
}
