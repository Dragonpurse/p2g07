package domein;

import java.util.ArrayList;
import java.util.List;
import org.joda.time.LocalDate;
import persistentie.Mapper;
import persistentie.MapperFactory;
import persistentie.SoortMapper;

public class Leertraject {

	private String leertrajectCode;
	private String titel;
	private String omschrijving;
	private LocalDate startdatum;
	private String doelgroep;
	private LocalDate beschikbaarVan;
	private LocalDate beschikbaarTot;
	private String externeMedewerker;
	private List<Onderdeel> onderdelenLijst;
	private Mapper<Onderdeel> onderdelenMapper;

	public Leertraject(String leertrajectCode, String titel, String omschrijving, LocalDate startDatum, String doelgroep, LocalDate beschikbaarVan, LocalDate beschikbaarTot, String externeMedewerker) {
		setLeertrajectCode(leertrajectCode);
		setTitel(titel);
		setOmschrijving(omschrijving);
		setStartdatum(startDatum);
		setDoelgroep(doelgroep);
		setBeschikbaarheidVan(beschikbaarVan);
		setBeschikbaarheidTot(beschikbaarTot);
		setExterneMedewerker(externeMedewerker);
		onderdelenMapper = MapperFactory.geefMapper(SoortMapper.ONDERDEEL);
		setOnderdelenLijst(new ArrayList<Onderdeel>());
	}
	
	public Leertraject(String leertrajectCode, String titel, String omschrijving, LocalDate startDatum, String doelgroep, LocalDate beschikbaarVan, LocalDate beschikbaarTot, String externeMedewerker,List<Onderdeel> onderdelenLijst) {
		this(leertrajectCode, titel, omschrijving, startDatum, doelgroep, beschikbaarVan, beschikbaarTot, externeMedewerker);
		setOnderdelenLijst(onderdelenLijst);
	}
 
	public void voegOnderdeelToe(Onderdeel onderdeel) {
		onderdelenMapper.voegItemToe(leertrajectCode, onderdeel);
		onderdelenLijst.add(onderdeel);
	}

	public void verwijderOnderdeel(Onderdeel onderdeel) {
		if(!onderdelenLijst.contains(onderdeel)){
			throw new IllegalArgumentException("Dit onderdeel bestaat niet");
		}
		onderdelenMapper.verwijderItem(leertrajectCode, onderdeel);
		onderdelenLijst.remove(onderdeel);
	}
	
	// tableModel methodes

	public Onderdeel geefOnderdeel(int index){
		return onderdelenLijst.get(index);
	}
	
	public int geefAantalOnderdelen(){
		return onderdelenLijst.size();
	}
	
	// 	getters & setters

	public String getLeertrajectCode() {
		return this.leertrajectCode;
	}

	public void setLeertrajectCode(String leertrajectCode) {
		if(leertrajectCode == "" || leertrajectCode == null)
			throw new IllegalArgumentException("Het veld leertrajectcode mag niet leeg zijn.");
		if(leertrajectCode.length() > 10)
			throw new IllegalArgumentException("Het veld leertrajectcode mag niet langer zijn dan 10 karakters.");
		this.leertrajectCode = leertrajectCode;
	}

	public String getTitel() {
		return this.titel;
	}
	
	public void setTitel(String titel) {
		if(titel == "" || titel == null)
			throw new IllegalArgumentException("Het veld titel mag niet leeg zijn.");
		if(titel.matches("[a-zA-Z0-9À-ž\\s-]*"))
				this.titel = titel;
		else throw new IllegalArgumentException("Het veld titel mag geen ongeldige tekens bevatten.");
	}

	public String getOmschrijving() {
		return this.omschrijving;
	}

	public void setOmschrijving(String omschrijving) {
		if(omschrijving == "" || omschrijving == null)
			throw new IllegalArgumentException("Het veld omschrijving mag niet leeg zijn");
		this.omschrijving = omschrijving;
	}

	public LocalDate getStartdatum() {
		return this.startdatum;
	}

	public void setStartdatum(LocalDate startDatum) {
		if(startDatum.isBefore(LocalDate.now()))
				throw new IllegalArgumentException("De startdatum kan niet voor de huidige datum zijn");
	    this.startdatum = startDatum;
	}

	public String getDoelgroep() {
		return this.doelgroep;
	}

	public void setDoelgroep(String doelgroep) {
		if(doelgroep == "" || doelgroep == null)
			throw new IllegalArgumentException("Het veld doelgroep mag niet leeg zijn");
		this.doelgroep = doelgroep;
	}

	public LocalDate getBeschikbaarheidVan() {
		return this.beschikbaarVan;
	}

	public void setBeschikbaarheidVan(LocalDate beschikbaarVan) {
		if(beschikbaarVan.isBefore(LocalDate.now()) && startdatum.isBefore(beschikbaarVan))
				throw new IllegalArgumentException("De begindatum van het traject kan niet voor de huidige datum of de startdatum zijn");
		this.beschikbaarVan = beschikbaarVan;
	}

	public LocalDate getBeschikbaarheidTot() {
		return this.beschikbaarTot;
	}

	public void setBeschikbaarheidTot(LocalDate beschikbaarTot) {
		if(beschikbaarTot.isBefore(LocalDate.now()) && beschikbaarTot.isBefore(beschikbaarVan) && beschikbaarTot.isBefore(startdatum))
				throw new IllegalArgumentException("De einddatum van het traject kan niet voor de huidige datum, de startdatum of de begindatum zijn");
		this.beschikbaarTot = beschikbaarTot;
	}

	public String getExterneMedewerker() {
		return this.externeMedewerker;
	}

	public void setExterneMedewerker(String externeMedewerker) {
		if(externeMedewerker == null)
			this.externeMedewerker = " ";
		this.externeMedewerker = externeMedewerker;
	}
	
	public List<Onderdeel> getOnderdelenLijst() {
		return onderdelenLijst;
	}

	public void setOnderdelenLijst(List<Onderdeel> onderdelenLijst) {
		this.onderdelenLijst = onderdelenLijst;
	}
}
